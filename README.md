# Multiclass Classification with ECOC and Label Switching Ensemble (LSEnsemble)

his repository implements a multiclass classification framework using Error-Correcting Output Codes (ECOC) and the Label Switching Ensemble (LSEnsemble) algorithm. LSEnsemble is employed for the binary classification tasks generated by ECOC, effectively improving accuracy, especially with imbalanced data.

## Project Overview

Error-Correcting Output Codes (ECOC) decompose multiclass data into multiple binary classification problems, which frequently exhibit significant class imbalance.

Error-Correcting Output Codes (ECOC) transform multiclass problems into multiple binary classification tasks. Even when the original multiclass data is balanced, binarization, particularly using a One-Versus-All (OVA) strategy, can introduce significant class imbalance. This imbalance creates challenges for standard machine learning algorithms, especially in optimal Bayes approximations, where accurate estimation of the likelihood ratio and subsequent threshold application are critical.

The Label Switching Ensemble (LSEnsemble) provides an alternative approach to address this issue by employing asymmetric label switching. This technique randomly swaps labels according to defined switching rates, introducing diversity within the ensemble, which positively impacts performance. Furthermore, by altering class populations, label switching effectively rebalances the original problem. This rebalancing facilitates the estimation of the (transformed) a priori probabilities and, consequently, the likelihood ratio for the base learners. Asymmetric label switching can be combined with other neutral rebalancing strategies, such as cost-sensitive learning and population-based adjustments, resulting in a transformed problem for which the optimal Bayes threshold can be theoretically computed.

For further details on likelihood ratio estimation and Bayes threshold transformations, see:
"Optimum Bayesian thresholds for rebalanced classification problems using class-switching ensembles," Pattern Recognition, 2022. [https://doi.org/10.1016/j.patcog.2022.109158](https://doi.org/10.1016/j.patcog.2022.109158)

## Key Features

* **ECOC Decomposition:**
    * Implementation of ECOC for effective multiclass to binary transformation.
    * Flexible ECOC encoding options configurable via `config.yaml`.
* **LSEnsemble Algorithm:**
    * Specialized algorithm for label switching correction, improving model robustness.
    * Configurable optimization parameters for LSEnsemble via `config.yaml`.
* **Comprehensive Evaluation:**
    * Evaluation suite using a range of multiclass metrics: balanced accuracy, Cohen's kappa, geometric mean, sensitivity.
    * Detailed logging and output for performance analysis.
* **Configuration-Driven Design:**
    * `config.yaml` allows for easy customization of datasets, models, and evaluation settings.
    * Streamlined model selection logic based on peak or average performance, configurable via `config.yaml`.
* **Model Persistence:**
    * Trained models and their configurations are saved using pickle for efficient testing and deployment.
    * Naming convention for the saved models that contains the parameters used for LSEnsemble.
* **Testing Script (`test.py`):**
    * Enables evaluation of pre-trained models without retraining, facilitating efficient testing.
    * Read the config.yaml file to load the parameters, and generate the model.
* **Dataset Flexibility:**
    * Designed to handle diverse datasets stored in a designated data folder.

## Getting Started

1.  **Clone the repository:**

    ```bash
    git clone [https://github.com/franjgs/MC_Label_Switching.git](https://github.com/franjgs/MC_Label_Switching.git)
    cd MC_Label_Switching
    ```

2.  **Configure `config.yaml`:**

    * Adjust settings for datasets, models, and evaluation parameters.

3.  **Run the training script:**

    ```bash
    python train.py
    ```

4.  **Run the testing script:**

    ```bash
    python test.py
    ```

## Dependencies

* Python 3.x
* scikit-learn
* NumPy
* Pandas
* PyYAML

## Datasets

* Place your datasets in the `datasets` folder (or specify the path in `config.yaml`).

## Output

* Trained models and evaluation metrics are saved in the `results` folder.

## Contributing

* Contributions are welcome! Please feel free to submit pull requests or open issues.

## License

* UC3M
